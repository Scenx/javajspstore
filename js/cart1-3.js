/* suning.com 1434052354207 */function checkMergeCart(){probeAuthStatus(function(){var e=$.cookie("mergeFlag");("undefined"==typeof e||"1"!=e)&&mergeCart()},function(){})}function mergeCart(){var e={storeId:"10052",isMerge:"1",supportPackage:"1",supportAccePack:"0",supportSunPack:"0",supportCheck:"1",supportCShop:"1",supportCShopCheck:"1",supportGroupbuy:"1",mpsChannel:"5",channel:"5",updateWAPCartCookie:1,supportXN:1};$.ajax({type:"get",url:SN.CART1_QUERY_URL,cache:!1,async:!1,dataType:"jsonp",data:e,jsonp:"callback",success:function(){},complete:function(){}})}checkMergeCart(),function(){var max=99,min=1,isUpdateQty=!1,delay=100,userPayAllPrice=0,totalDiscount=0,checkedItem="",snAllItemList,cAllItemList,canCheckAllItem=!1,allItemChecked=!0,updateFlag="0",userPayAllPriceHwg=0,totalDiscountHwg=0,hwgAllItemList=[],hwgQty=0,isDelAllFlag=!1,delMessageArr=[],initUidArr=[],updateUidArr=[],imgHost=SN.IMG_HOST,imgHostTag=SN.IMG_HOST_TAG,imgHostNumber=SN.IMG_HOST_NUMBER,tag=Math.floor(Math.random()*parseInt(imgHostNumber)+1);imgHost=imgHost.replace(imgHostTag,tag),window.onload=function(){Cart.initCart()},Cart.initCart=function(){Cart.queryOverSea.initOverSea(),Cart.initCart1()},Cart.initCart1=function(){Cart.emptyCart.isCartEmpty()?probeAuthStatus(function(){var e={storeId:"10052",curCityId:$.cookie("cityId")||"9173",channel:"5",mpsChannel:"5",supportPackage:"1",supportAccePack:"0",updateInfo:"{}",updateWAPCartCookie:1};Cart.queryData.cartQuery(e)},function(){initUidArr.push(0),Cart.useMethod.isEmptyCart(initUidArr)?Cart.useMethod.showEmptyCart():$("#loading").hide()}):Cart.queryData.initialCartInfo()},Cart.queryOverSea={initOverSea:function(){var e=this,t={userFlag:0,opType:1,operationChannel:50,operationTerminal:"01",operationEquipment:"02"};$.ajax({type:"get",url:SN.WAP_OVERSEA_SHOW,dataType:"json",data:t,beforeSend:function(){$("#loading").show()},success:function(t){initUidArr.push(1),"0"==t.code?Cart.useMethod.isEmptyCart(initUidArr)?Cart.useMethod.ajaxInitFail(initUidArr):Cart.useMethod.ajaxFixedBox(initUidArr):(e.getOverSeaData(t),Cart.useMethod.isEmptyCart(initUidArr)?Cart.useMethod.showEmptyCart():Cart.useMethod.ajaxFixedBox(initUidArr))},complete:function(){},error:function(){initUidArr.push(0),Cart.useMethod.isEmptyCart(initUidArr)?Cart.useMethod.ajaxInitFail(initUidArr):Cart.useMethod.ajaxFixedBox(initUidArr)}})},getOverSeaData:function(e){var t=this;$("#hwgList").html(""),hwgQty=0;var r=e.data.cmmdtyInfos,a=e.data.cartHeadInfo;hwgAllItemList=r;for(var i=e.data.errorInfos,o=e.data.discountInfos,n=[],s=0;s<r.length;s++){var c=r[s].mainCmmdtyInfo.mainCmmdtyDetailInfo,l=r[s].cmmdtyHeadInfo.activityType,d=!1;$("#hwgList").find(".cart-list").each(function(){return $(this).attr("id").split(/\_/g)[1]==c.shopCode?(d=!0,!1):void 0}),c.hwgUrl="http://shop."+SN.APP_URL+"/"+c.shopCode+".html",!d&&$("#hwgList").append(template("hwgList_temp",{value:c}));var u="";"1"==c.tickStatus&&(u='checked="true"',hwgQty=parseInt(hwgQty)+parseInt(c.cmmdtyQty));var p="";"1"!=c.cmmdtyStatus&&(p="disabled=disabled"),c.proTagText="02"==l?"闪购":"";var h=!1,m=!1,C=t.getDiscountList(o,c.itemNo);if(Cart.isNotNull(C)){for(var f=0;f<n.length;f++)if(n[f]==C.promotionId){m=!0;break}!m&&n.push(C.promotionId),h=!0}var g="",v="";c.cmmdtyQty<=min?g="cover":c.cmmdtyQty>=max&&(v="cover"),c.minCover=g,c.maxCover=v,c.errorMessage="error_message_hwg_"+c.itemNo,c.errorDesc=t.getOverSeaError(i,c.itemNo,c.cmmdtyQty),c.checked=u,c.diabled=p,c.special="",c.imgUrl=imgHost+"/b2c/catentries/"+c.cmmdtyCode+"_1_120x120.jpg",c.orderItemId=c.itemNo,c.supplierCode=c.shopCode,c.partNumber=c.cmmdtyCode,c.productName=c.cmmdtyName,c.quantity=c.cmmdtyQty,c.itemPrice=Cart.isNotNull(c.salesPrice)?"¥"+c.salesPrice:"--",c.webPrice=Cart.isNotNull(c.listPrice)&&Cart.isNotNull(c.proTagText)?"¥"+c.listPrice:"",c.type="HWG";var y=$("#hwgList_"+c.shopCode).find(".cart-item");if(h){if(c.orderLevelPromId=C.promotionId,c.shortDesc=C.promotionDesc,!m){var k=template("promList_temp",{value:c});y.append(k)}y.find("#prom_"+C.promotionId).append(template("promList_son_temp",{value:c}))}else y.append(template("itemList_temp",{value:c}))}userPayAllPriceHwg=a.salesAmount||0,totalDiscountHwg=a.promotionAmount||0,Cart.useMethod.setSupCheckedAll("#hwgList")},updateOverSea:function(e,t){var r=this,a={cartHeadInfo:{userFlag:0,operationChannel:50,operationTerminal:"01",operationEquipment:"02"},operationInfos:e};$.ajax({type:"post",url:SN.WAP_OVERSEA_UPDATE,dataType:"json",data:{data:JSON.stringify(a)},beforeSend:function(){$("#loading").show()},success:function(a){updateUidArr.push(1),!isDelAllFlag&&"isAll"!=t&&(updateUidArr=[1,1]),"0"==a.code?Cart.useMethod.ajaxUpdateFail(updateUidArr):0==a.data.cmmdtyInfos.length&&a.data.errorInfos&&a.data.errorInfos.length>0?isDelAllFlag?Cart.useMethod.delAlertMessage(updateUidArr,0):r.getFirstErrorInfosOverSea(a.data.errorInfos):parseInt($("#cartEdit").attr("rel"))&&"isFav"!=t&&"isDel"!=t?(isUpdateQty=!0,0==a.data.errorInfos.length?$("#error_message_hwg_"+e[0].itemNo).html(""):r.setErrorInfosOverSea(a.data.errorInfos)):(r.getOverSeaData(a),"isDel"==t&&(isDelAllFlag?Cart.useMethod.delAlertMessage(updateUidArr,1):Cart.useMethod.alertMini("删除成功")))},complete:function(){isUpdateQty?$("#loading").hide():Cart.useMethod.isEmptyCart(updateUidArr)?Cart.useMethod.showEmptyCart():($(".cart-list-opra").addClass("no-effect"),Cart.useMethod.ajaxFixedBox(updateUidArr))},error:function(){updateUidArr.push(0),Cart.useMethod.ajaxUpdateFail(updateUidArr)}})},getOverSeaError:function(e,t){for(var r="",a=0;a<e.length;a++)if(e[a].itemNo==t){r=e[a].errorMessage;break}return r},getDiscountList:function(e,t){for(var r=0;r<e.length;r++){if(!e[r].cmmdtyLineInfos.length)return;var a=e[r].cmmdtyLineInfos[0].itemNo,i=e[r].discountDetailInfo,o=i.promotionType;if(Cart.isNotNull(a)&&a==t&&("3"==o||"5"==o||"6"==o||"7"==o)){var n={promotionId:i.promotionId,promotionDesc:i.promotionDesc};return n}}return""},setErrorInfosOverSea:function(e){for(var t=0,r=e.length;r>t;t++){var a=$("#error_message_hwg_"+e[t].itemNo);Cart.isNotNull(e[t].errorMessage)&&a.length>0&&a.html(e[t].errorMessage)}},getFirstErrorInfosOverSea:function(e){if(e.length>0){var t=$("#error_message_hwg_"+e[0].itemNo);Cart.useMethod.alertMini(t.length>0?t.parents("dt").find(".text-clamp2").html()+e[0].errorMessage:e[0].errorMessage)}else Cart.useMethod.alertMini("啊哦~操作失败了"),setTimeout(function(){Cart.useMethod.refreshCurPage()},2e3)},querySettlementOverSea:function(){var e=this,t={cartHeadInfo:{userFlag:0,directFlag:0,operationChannel:50,operationTerminal:"01",operationEquipment:"02",districtCode:$.cookie("districtCode")||11365,cityCode:$.cookie("cityId")||9173,provinceCode:$.cookie("provinceCode")||100}};$.ajax({type:"post",url:SN.WAP_OVERSEA_SETTLEMENT,dataType:"json",data:{data:JSON.stringify(t)},beforeSend:function(){$("#loading").show()},success:function(t){if(Cart.isNotNull(t.msg))Cart.useMethod.alertMini(t.msg);else if(1==t.code&&"Y"==t.data.result.isSuccess&&0==t.data.errorInfos.length)Cart.linkUrl.goCart2OverSea();else if(t.data.errorInfos.length>0&&"CSC-10-0005"==t.data.errorInfos[0].errorCode){Cart.useMethod.alertMini(t.data.errorInfos[0].errorMessage);var r=setTimeout(function(){r=null,Cart.useMethod.refreshCurPage()},2e3)}else e.setErrorInfosOverSea(t.data.errorInfos),e.getFirstErrorInfosOverSea(t.data.errorInfos),Cart.useMethod.setSupCheckedAll("#hwgList"),Cart.useMethod.initialCheckedAll()},complete:function(){$("#loading").hide()},error:function(){Cart.useMethod.alertMini("网络连接失败，请检测您的网络环境稍后重试")}})}},Cart.queryData={initialCartInfo:function(){probeAuthStatus(function(){var e={storeId:"10052",curCityId:$.cookie("cityId")||"9173",channel:"5",mpsChannel:"5",supportPackage:"1",supportAccePack:"0",updateInfo:"{}",updateWAPCartCookie:1,supportXN:1};Cart.queryData.cartQuery(e)},function(){var e={storeId:"10052",isMerge:"0",supportCShop:"1",supportPackage:"1",supportAccePack:"0",supportCShopCheck:"1",mpsChannel:"5",channel:"5",updateWAPCartCookie:1,supportXN:1};Cart.queryData.cartQuery(e)})},cartQuery:function(e){var t=this;$.ajax({type:"get",url:SN.CART1_QUERY_URL,data:e,dataType:"jsonp",jsonp:"callback",success:function(e){initUidArr.push(1),$("#cartList").html(""),allItemChecked=!0,canCheckAllItem=!0,checkedItem="",t.initialSNCartList(e),t.initialCCartList(e.cShopList),$.cookie("checkedItems",","+checkedItem,{path:"/",domain:SN.IDS_COOKIE_DOMAIN,expires:10}),userPayAllPrice=e.userPayAllPrice||0,totalDiscount=e.totalDiscount||0,Cart.useMethod.isEmptyCart(initUidArr)?Cart.useMethod.showEmptyCart():Cart.useMethod.ajaxFixedBox(initUidArr)},complete:function(){},error:function(){initUidArr.push(0),Cart.useMethod.isEmptyCart(initUidArr)?Cart.useMethod.ajaxInitFail(initUidArr):Cart.useMethod.ajaxFixedBox(initUidArr)}})},initialSNCartList:function(e){function t(){o>0?$("#promotePay").show()&&$("#promotePay").parent(".cart-sn-ico").addClass("line"):$("#freePay").show()&&$("#freePay").prev(".cart-sn-ico").removeClass("line")}function r(){$("#promotePay").show()&&$("#promotePay").parent(".cart-sn-ico").addClass("line"),$("#freePay").hide()}var a=this;snAllItemList=e.itemList;var i=e.itemList;if(i.length<1)return void $("#snList").html("");var o=parseInt(e.snTotalShipPrice,10);$("#cartList").append(template("snList_temp",{limitedAmount:parseInt(e.limitedAmount,10)}));var n=a.initDataList("SN",i),s=n.allShopChecked,c=n.canCheckAllShop;c||(s=!1);var l=$("#chooseAllSNCheckBox");s?(l.attr({checked:"true"}),t()):""!=checkedItem?t():r(),!c&&l.attr({disabled:"disabled"}),c||r()},initialCCartList:function(e){var t=this;if(cAllItemList=e,!(e.length<1))for(var r=0;r<e.length;r++){var a=e[r].itemList;e[r].cShopUrl="http://shop."+SN.APP_URL+"/"+e[r].supplierCode+".html",$("#cartList").append(template("cShopList_temp",{value:e[r]}));var i=t.initDataList("cShop",a,e[r].supplierCode),o=i.allShopChecked,n=i.canCheckAllShop;n||(o=!1);var s=$("#cShopList_"+e[r].supplierCode).find(".cart-title").find("input:first-child");o&&s.attr({checked:"true"}),!n&&s.attr({disabled:"disabled"})}},buildXnPackage:function(e){for(var t=e.xnPackageList,r=0;r<t.length;r++)t[r].imgUrl=imgHost+"/b2c/catentries/"+t[r].partNumber+"_1_120x120.jpg",t[r].itemPrice=Cart.isNotNull(t[r].itemPrice)?"¥"+t[r].itemPrice:"--",Cart.isNotNull(e.isChecked)&&"1"==e.isChecked&&(checkedItem+=t[r].orderItemId+",");return t},initDataList:function(e,t,r){for(var a=this,i="SN"==e?!0:!1,o=!0,n=!1,s=[],c=0;c<t.length;c++){var l=!1,d=t[c].isChecked,u="";null!=d&&"1"==d?(u='checked="true"',checkedItem+=t[c].orderItemId+","):"1"!=t[c].isCanntCheck&&(o=!1,allItemChecked=!1),t[c].checked=u,"1"!=t[c].isCanntCheck&&(n=!0,canCheckAllItem=!0),t[c].imgUrl=imgHost+"/b2c/catentries/"+t[c].partNumber+"_1_120x120.jpg";var p=t[c].special,h="",m="7"==p?"大聚惠":"16"==p?"抢购":"17"==p?"团购":"18"==p?"名品特卖":"19"==p?"手机专享":"9"==p?"直降":"SMALLPACKAGE"==t[c].packageType?"套餐价":"";t[c].proTagText=m,"1"==t[c].isCanntCheck&&(h="disabled=disabled"),t[c].diabled=h,t[c].itemPrice=Cart.isNotNull(t[c].itemPrice)?"¥"+t[c].itemPrice:"--",t[c].webPrice=Cart.isNotNull(t[c].webPrice)?"¥"+t[c].webPrice:"";var C=i?"error_message_":"error_message_cshop_";t[c].errorMessage=C+t[c].orderItemId;var f="",g="";if(t[c].quantity<=min?f="cover":t[c].quantity>=max&&(g="cover"),t[c].minCover=f,t[c].maxCover=g,t[c].type=e,"SMALLPACKAGE"==t[c].packageType&&(Cart.isNotNull(t[c].errorDesc)||$.each(t[c].smallPackageList,function(e,r){return Cart.isNotNull(r.errorDesc)?(t[c].errorDesc=r.errorDesc,!1):void 0})),"XNPACKAGE"==t[c].packageType){t[c].xnCount=t[c].xnPackageList.length;var v=a.buildXnPackage(t[c]);l=!0}var y=!1,k=!1;if(("1"==t[c].orderLevelPromType||"3"==t[c].orderLevelPromType||"4"==t[c].orderLevelPromType)&&""!=t[c].orderLevelPromId){for(var I=0;I<s.length;I++)if(s[I]==t[c].orderLevelPromId){k=!0;break}!k&&s.push(t[c].orderLevelPromId),y=!0}var A={value:t[c],xnList:v,supplierCode:r,errorTag:C},S=$(i?"#snList":"#cShopList_"+r);if(l){var P=template("xnList_temp",A);S.find(".cart-item").append(P)}else if(y){if(!k){var P=template("promList_temp",A);S.find(".cart-item").append(P)}S.find("#prom_"+t[c].orderLevelPromId).append(template("promList_son_temp",A))}else{var P=template("itemList_temp",A);S.find(".cart-item").append(P)}}return{allShopChecked:o,canCheckAllShop:n}}},Cart.linkUrl={goCart2:function(){window.location.href="cart2.html"},goCart2OverSea:function(){window.location.href="cart2.html?cartType=mtis"},goFourthPage:function(e,t,r){e=e.substring(9,18);var a="18"==r?SN.APP+"/mp/":SN.WAP_PRODUCT_DETAIL_URL,i="";""!=t?t+="/":"18"==r&&(t="0000000000/",i="?v=3"),window.location.href=a+t+e+".html"+i},goLogon:function(){window.location.href=SN.PASSPORT+"/login?service="+SN.AQ+"?targetUrl="+SN.CART+"/cart/cart1.html?terminalFlag=0&loginTheme=wap_new"}},Cart.useMethod={isDigit:function(e){var t=/^([0-9]+)$/;return t.test(e)},refreshCurPage:function(){document.location.reload()},hideCart1:function(){$(".cart-foot-bar").hide()},showCart1:function(){$("#cartDel").hide(),$("#cartTotal")[0].style.display="block"},initialUserPayAllPrice:function(){var e=parseFloat(userPayAllPrice)+parseFloat(userPayAllPriceHwg);$("#userPayAllPrice").html(Cart.toFixed(e))},initialTotalDiscount:function(){var e=parseFloat(totalDiscount)+parseFloat(totalDiscountHwg);$("#totalDiscount").html(Cart.toFixed(e))},initialCheckedAll:function(){var e=this,t=!e.isAllDisabled("#hwgList")&&!e.isAllDisabled("#cartList"),r=e.isAllChecked("#hwgList")&&e.isAllChecked("#cartList");t?($("#footCheck").prop("checked",!1),$("#footCheck").attr("disabled","disabled")):$("#footCheck").prop("checked",r)},initialEditButton:function(){$("#cartEdit").html("编辑").attr("rel",0),$(".cart-list-opra").each(function(){$(this).removeClass("opra")}),$("input.del-checkbox").prop("checked",!1).hide(),$("input.opt-checkbox").show(),$("#cartTotal")[0].style.display="block",$("#cartDel").hide()},shipCharge:function(e){parseFloat(e)>0?$("#shipCharge").show():$("#shipCharge").hide()},hideNav:function(){$("#sub-title").hide(),$("#screenIfmNav").hide()},batchDelInit:function(e,t){var r="sn-btn sn-btn-dark sn-btn-big",a="sn-btn sn-btn-assertive sn-btn-big",i=e?a:r;$("#delOption").removeClass().addClass(i),$("#delCount").html(t)},initFixedStyle:function(){$(".cart-fixed").css("position","fixed")},alertMini:function(e){AlertBox({type:"mini",msg:e})},isHasChecked:function(e){var t=!1,r=$(e).find(".cart-list");return r.each(function(){var e=$(this).find(".cart-item").find("input.opt-checkbox");e.each(function(){"disabled"!=$(this).attr("disabled")&&$(this).prop("checked")&&(t=!0)})}),t},isAllChecked:function(e){var t=!0,r=$(e).find(".cart-title");return r.each(function(){var e=$(this).find("input.opt-checkbox");"disabled"==e.attr("disabled")||e.prop("checked")||(t=!1)}),t},isAllDisabled:function(e){var t=!1,r=$(e).find(".cart-title");return r.each(function(){var e=$(this).find("input.opt-checkbox");e.prop("disabled")||(t=!0)}),t},setSupCheckedAll:function(e){var t=$(e).find(".cart-list");t.each(function(){var e=!0,t=0,r=$(this).find(".cart-title").find("input.opt-checkbox"),a=$(this).find(".cart-item").find("input.opt-checkbox"),i=a.length;a.each(function(){var r=$(this);r.prop("checked")||"disabled"==r.attr("disabled")||(e=!1),"disabled"==r.attr("disabled")&&t++}),r.prop("checked",e),i==t&&r.prop("checked",!1).attr("disabled","disabled")})},setHwgAllCheckedItem:function(e,t){var r=[],a=$(e).find(".cart-list");return a.each(function(){var e=$(this).find(".cart-item").find("input.opt-checkbox");e.each(function(){var e=$(this).val(),a={itemNo:e,tickStatus:t};r.push(a)})}),r},getEditAllCheckedItem:function(e){var t=[],r=$(e).find(".cart-list");return r.each(function(){var e=$(this).find(".cart-item").find("input.del-checkbox");e.each(function(){var e=$(this);"disabled"!=e.attr("disabled")&&e.prop("checked")&&t.push($(this).val())})}),t},initFixedBox:function(){var e=this;$("#loading").hide(),Cart.settlement.checkSettlement(),e.initialUserPayAllPrice(),e.initialTotalDiscount(),Cart.useMethod.initialEditButton(),Cart.editOptionHandle(),e.initialCheckedAll(),initUidArr=[],updateUidArr=[]},initAllChecked:function(){$("#loading").hide()&&Cart.useMethod.initialCheckedAll()},ajaxFixedBox:function(e){var t=this;t.ajaxOption(e)&&t.initFixedBox()},ajaxNumber:function(e){return 2==e?!0:!1},ajaxOption:function(e){return 2==e.length&&(e[0]||e[1])},ajaxInitFail:function(e){var t=this;t.ajaxOption(e)&&($("#loading").hide(),Cart.useMethod.hideCart1(),$("#cartLogin").removeClass().addClass(failLoadingCls).show().find("#cartBtn").attr("href","javascript:Cart.useMethod.refreshCurPage();"))},ajaxUpdateFail:function(e){var t=this;t.ajaxOption(e)&&($("#loading").hide(),t.alertMini("网络连接失败，请检测您的网络环境稍后重试"))},delAlertMessage:function(e,t){if(delMessageArr.push(t),2==e.length){{var r=delMessageArr[0];delMessageArr[1]}Cart.useMethod.alertMini(r==r?r?"删除成功":"删除失败":"删除失败"),isDelAllFlag=!1}},showEmptyCart:function(){$("#loading").hide(),$("#cartEdit").hide(),Cart.emptyCart.showEmptyCart1(),Cart.useMethod.hideCart1(),Cart.updateCookie.initialEmptyQty(),Cart.emptyCart.synchCartInfo()},isEmptyCart:function(e){return""==$("#cartList").html().trim()&&""==$("#hwgList").html().trim()&&2==e.length?!0:!1}};var loginEmptyCls="cart-1-6 cart-1-6_001",unLoginEmptyCls="cart-1-6 cart-1-6_002",loadingCls="cart-1-6 cart-1-6_003",failLoadingCls="cart-1-6 cart-1-6_004",failNetCls="cart-1-6 cart-1-6_005";Cart.emptyCart={synchCartInfo:function(){var e={storeId:"10052",isMerge:"0",supportCShop:"1",supportPackage:"0",supportCShopCheck:"1",mpsChannel:"5",channel:"5",updateWAPCartCookie:1,supportXN:1};$.ajax({type:"get",url:SN.CART1_QUERY_URL,dataType:"jsonp",data:e,jsonp:"callback",success:function(){},complete:function(){}})},isCartEmpty:function(){var e="{}",t=$.cookie("cartv30");return null==t||"undefined"==typeof t||""==t||t==e?!0:!1},showEmptyCart1:function(){probeAuthStatus(function(){$("#cartLogin").removeClass().addClass(loginEmptyCls).show().find("#cartBtn").attr("href",SN.APP_V3+"/index.html")},function(){$("#cartLogin").addClass(unLoginEmptyCls).show().find("#cartBtn").attr("href","javascript:Cart.linkUrl.goLogon();")})}};var selectAllItemsTimer=null,doForSelectTimer=null;Cart.checkedItem={selectAllItems:function(e,t,r){null!=selectAllItemsTimer&&clearTimeout(selectAllItemsTimer);var a=e.checked,i="",o={};switch(i=1==a?"1":"0",t){case"SN":var o=Cart.checkedItem.getCheckedItem(snAllItemList,i);selectAllItemsTimer=setTimeout(function(){Cart.updateCookie.updateCookieCheck("","","SN",i,"",o)},delay);break;case"cShop":$.each(cAllItemList,function(e,t){t.supplierCode==r&&(o=Cart.checkedItem.getCheckedItem(t.itemList,i))}),selectAllItemsTimer=setTimeout(function(){Cart.updateCookie.updateCookieCheck("",r,"C",i,"",o)},delay);break;case"HWG":var n=[];$(e).parents(".cart-list").find(".cart-item").find("input.opt-checkbox").each(function(){var e=$(this).val(),t={itemNo:e,tickStatus:i};n.push(t)}),selectAllItemsTimer=setTimeout(function(){Cart.queryOverSea.updateOverSea(n)},delay);break;case"All":Cart.useMethod.hideNav();var s=Cart.useMethod.setHwgAllCheckedItem("#hwgList",i),c=[],l=0;$.each(snAllItemList||[],function(e,t){c[l]={itemId:t.orderItemId+"",productId:"",quantity:"",special:"",flag:i+"",deleteFlag:""},l++}),$.each(cAllItemList||[],function(e,t){$.each(t.itemList,function(e,t){c[l]={itemId:t.orderItemId+"",productId:"",quantity:"",special:"",flag:i+"",deleteFlag:""},l++})}),o={items:c},selectAllItemsTimer=setTimeout(function(){updateUidArr=[],s.length>0&&Cart.queryOverSea.updateOverSea(s,c.length>0?"isAll":""),c.length>0&&Cart.updateCookie.updateCookieCheck("","","ALL",i,"",o,s.length>0?"isAll":"")},delay)}},getCheckedItem:function(e,t){var r="",a=[];return $.each(e,function(e,i){r={itemId:i.orderItemId+"",productId:"",quantity:"",special:"",flag:t+"",deleteFlag:""},a[e]=r}),{items:a}},doForSelectShop:function(e,t,r,a){null!=doForSelectTimer&&clearTimeout(doForSelectTimer);{var i=e.checked,o="";Cart.isNotNull(a)}if(o=1==i?"1":"0","HWG"==t){var n=[{itemNo:r,tickStatus:o}];doForSelectTimer=setTimeout(function(){Cart.queryOverSea.updateOverSea(n)},delay)}else doForSelectTimer=setTimeout(function(){Cart.updateCookie.updateCookieCheck(r,a,"",o,r,"")},delay)}};var editDelItemId=[];Cart.checkAll=function(e){var t="#delFootCheck",r="input[type=checkbox]:nth-child(2)",a="input[type=checkbox].del-checkbox";$(".cart-list").each(function(){function i(e,t){e.prop("checked",t)}function o(){var o=!1,n=$(t),s=0;editDelItemId=[],$(".cart-list").each(function(){$(this).find(".cart-title").find(r).each(function(){$(this).prop("checked")||(o=!0)}),$(this).find(".cart-item").find(a).each(function(){$(this).prop("checked")&&(s++,editDelItemId.push($(this).val()))})}),e&&e(s),o?i(n,!1):i(n,!0)}function n(e){var t=!1,n=e.parents(".cart-list").find(".cart-title").find(r);e.parents(".cart-item").find(a).each(function(){$(this).prop("checked")||(t=!0)}),t?i(n,!1):i(n,!0),o()}var s=$(this),c=s.find(".cart-title").find(r),l=s.find(".cart-item").find(a);c.click(function(){var e=$(this);e.prop("checked")?i(l,!0):i(l,!1),o()}),l.click(function(){n($(this))})}),$(t).unbind().on("click",function(){Cart.useMethod.hideNav();var t=0,r=$(".cart-list").find(a);editDelItemId=[],$(this).prop("checked")?($(".cart-list").find(".cart-item").find(a).each(function(){t++,editDelItemId.push($(this).val())}),r.prop("checked",!0)):r.prop("checked",!1),e&&e(t)})},Cart.editOptionHandle=function(){Cart.editOption(function(){$("#cartTotal").hide(),$("#cartDel")[0].style.display="block",$("input[type='checkbox'].opt-checkbox").hide(),$("input[type='checkbox'].del-checkbox").prop("checked",!1).show()},function(){$("#cartDel").hide(),$("#cartTotal")[0].style.display="block",$("input[type='checkbox'].opt-checkbox").show(),$("input[type='checkbox'].del-checkbox").prop("checked",!1).hide()},function(){Cart.useMethod.batchDelInit(!1,0),Cart.useMethod.hideNav(),Cart.checkAll(function(e){e?Cart.useMethod.batchDelInit(!0,e):Cart.useMethod.batchDelInit(!1,0)})})},Cart.editOption=function(e,t,r){$("#cartEdit").unbind().on("click",function(){var a=$(".cart-list-opra");a.removeClass("no-effect"),a.hasClass("opra")?(a.removeClass("opra"),$(this).html("编辑").attr("rel",0),isUpdateQty?(Cart.initCart(),$("#footCheck").show(),isUpdateQty=!1):t&&t()):(a.addClass("opra"),$(this).html("完成").attr("rel",1),e&&e()),r&&r()}),$("#delOption").unbind().on("click",function(){if(parseInt($("#delCount").html(),10)>0){for(var e=Cart.useMethod.getEditAllCheckedItem("#hwgList"),t=Cart.useMethod.getEditAllCheckedItem("#cartList"),r=[],a=0,i=e.length;i>a;a++){var o={itemNo:e[a],deleteFlag:"Y"};r.push(o)}e.length>0&&t.length>0?(updateUidArr=[],isDelAllFlag=!0,Cart.delItem.delItemConfirm(t,null,r)):(e.length>0&&Cart.delItem.delItemConfirm(r,"HWG"),t.length>0&&Cart.delItem.delItemConfirm(t))}})};var qtyTimer=null;Cart.updateQty={updateButtonQty:function(e,t,r){function a(e){o.val(e),i.parent(".sn-count").find("a").removeClass("cover")}null!=qtyTimer&&clearTimeout(qtyTimer);var i=$(e),o=i.parent().find("input"),n=o.val();if("count-min"==e.className.trim())n--,min>=n?(o.val(min),i.addClass("cover"),i.parent(".sn-count").find("a.count-add").removeClass("cover")):a(n);else{if("count-add"!=e.className.trim())return;n++,n>max?(o.val(max),i.addClass("cover")):a(n)}"HWG"==r?qtyTimer=setTimeout(function(){var e=[{itemNo:t,requestQty:n}];Cart.queryOverSea.updateOverSea(e)},delay):(updateFlag="1",qtyTimer=setTimeout(function(){Cart.updateCookie.updateCookieQty(t,n)},delay))},updateInputQty:function(e,t,r){var a=parseInt($(e).val());if(Cart.useMethod.isDigit(a)||$(e).val(min),a>=max?($(e).val(max),a=max,$(e).next().addClass("cover")):min>=a?($(e).val(min),a=min,$(e).prev().addClass("cover")):($(e).next().removeClass("cover"),$(e).prev().removeClass("cover")),"HWG"==r){var i=[{itemNo:t,requestQty:a}];Cart.queryOverSea.updateOverSea(i)}else updateFlag="1",Cart.updateCookie.updateCookieQty(t,a)}},Cart.delItem={delItemConfirm:function(e,t,r){var a=this;AlertBox({title:"是否确认删除？",confirm:function(){if("HWG"==t){if(Array.isArray(e))i=e;else var i=[{itemNo:e,deleteFlag:"Y"}];Cart.queryOverSea.updateOverSea(i,"isDel")}else Cart.isNotNull(r)&&Cart.queryOverSea.updateOverSea(r,"isDel"),probeAuthStatus(function(){Cart.updateService.updateServerItem(e,"","1","","","")},function(){a.delItemNotice(Array.isArray(e)?e.join(","):e)})},cancel:function(){}})},delItemNotice:function(e){var t={itemId:e};$.ajax({type:"get",url:SN.APP+"/cart1/delItem.do",dataType:"jsonp",jsonp:"callback",data:t,success:function(e){"SUCCESS"==e.data.result?(Cart.useMethod.alertMini("删除成功"),setTimeout(function(){Cart.useMethod.refreshCurPage()},2e3)):Cart.useMethod.alertMini("删除失败")}})},delItem:function(e,t){if("HWG"==e){var r=[{itemNo:t,deleteFlag:"Y"}];Cart.queryOverSea.updateOverSea(r,"isFav")}else Cart.updateService.updateServerItem(t+"","","1","1")}},Cart.favItem={addFav:function(e,t,r,a){var i=this;probeAuthStatus(function(){i.callFav(e,t,r,a)},function(){Cart.linkUrl.goLogon()})},callFav:function(e,t,r,a){var i=SN.APP+"/favorite/private/addGoodsFavorite.do?shopId="+a+"&partnumber="+r+"&channel=WAP",o="成功移动到收藏夹";$.ajax({url:i,dataType:"jsonp",jsonp:"callback",type:"get",success:function(r){"0"==r.returnCode||"-1"==r.returnCode?(Cart.useMethod.alertMini(o),setTimeout(function(){Cart.delItem.delItem(e,t)},2e3)):Cart.useMethod.alertMini("收藏失败")}})}},Cart.settlement={checkSettlement:function(){var e=$.cookie("totalCheckedQty"),t=0;if(void 0==e||"undefined"==e)if(null!=userPayAllPrice&&"0.00"!=userPayAllPrice||null!=userPayAllPriceHwg&&"0.00"!=userPayAllPriceHwg){var r="";Cart.isNotNull(userPayAllPriceHwg)&&"0.00"!=userPayAllPriceHwg&&0!=userPayAllPriceHwg?(t=parseInt(hwgQty,10),r='(<span id="totalProdQty">'+t+"</span>)"):r="",$("#goSettlement").html('<a href="javascript:Cart.settlement.predo(\'Cart.settlement.goSettlement()\');" class="sn-btn sn-btn-assertive sn-btn-big">去结算'+r+"</a>")}else $("#goSettlement").html('<span class="sn-btn sn-btn-dark sn-btn-big">去结算</span>');else t=parseInt(e,10)+parseInt(hwgQty,10),$("#goSettlement").html(null!=userPayAllPrice&&"0.00"!=userPayAllPrice||null!=userPayAllPriceHwg&&"0.00"!=userPayAllPriceHwg?'<a href="javascript:Cart.settlement.predo(\'Cart.settlement.goSettlement()\');" class="sn-btn sn-btn-assertive sn-btn-big">去结算(<span id="totalProdQty">'+t+"</span>)</a>":'<span class="sn-btn sn-btn-dark sn-btn-big">去结算(<span id="totalProdQty">'+t+"</span>)</span>")},goSettlement:function(){var e=this,t=Cart.useMethod.isHasChecked("#hwgList"),r=Cart.useMethod.isHasChecked("#cartList");t&&r?Cart.useMethod.alertMini("【海外购商品】和【非海外购商品】不可一起结算，请分开进行结算"):t?Cart.queryOverSea.querySettlementOverSea():r&&e.querySettlement()},querySettlement:function(){var e=this,t={storeId:"10052",curCityId:$.cookie("cityId")||"9173",submit_method:"1",channel:"5",mpsChannel:"5",cshopFlag:"",updateWAPCartCookie:1,supportXN:1};$.ajax({type:"get",url:SN.CART1_SETTLE_URL,dataType:"jsonp",data:t,jsonp:"callback",beforeSend:function(){$("#loading").show()},success:function(t){if($("#loading").hide(),"1"==t.isSuccess)Cart.linkUrl.goCart2();else if(Cart.isNotNull(t.errorMessage))Cart.useMethod.alertMini(t.errorMessage);else{e.setSettleChecked(t);var r=e.getErrorDesc(t);""!=r?Cart.useMethod.alertMini(r):(Cart.useMethod.alertMini(""!=t.errorMessage?t.errorMessage:"啊哦~操作失败了"),setTimeout(function(){Cart.useMethod.refreshCurPage()},2e3)),e.refreshErrorDesc(t.exceptionList,t.cShopExceptionList)}},complete:function(){},error:function(){$("#loading").hide(),Cart.useMethod.alertMini("网络连接失败，请检测您的网络环境稍后重试")}})},setSettleChecked:function(e){userPayAllPrice=e.userPayAllPrice||0,totalDiscount=e.totalDiscount||0,Cart.useMethod.initFixedBox();var t=!1;$.each(e.exceptionList,function(e,r){var a=r.isChecked,i=r.isCanntCheck;"1"!=a&&"1"!=i&&($("#error_message_"+r.orderItemId).parents("dt").find(".opt-checkbox").prop("checked",!1),t=!0)}),t&&$("#chooseAllSNCheckBox").prop("checked",!1);var r=!1;$.each(e.cShopExceptionList,function(e,t){var a=!1;$.each(t.itemList,function(e,t){var r=t.isChecked,i=t.isCanntCheck;"1"!=r&&"1"!=i&&($("#error_message_cshop_"+t.orderItemId).parents("dt").find(".opt-checkbox").prop("checked",!1),a=!0)}),a&&$("#cShopList_"+t.supplierCode).find(".cart-title").find(".opt-checkbox").prop("checked",!1)&&(r=!0)}),(t||r)&&$("#footCheck").prop("checked",!1)},getErrorDesc:function(e){var t="",r=$.cookie("checkedItems");return $.each(e.exceptionList,function(e,a){return r.indexOf(","+a.orderItemId+",")>=0&&Cart.isNotNull(a.errorDesc)?(t=a.productName+a.errorDesc,"SMALLPACKAGE"==a.packageType&&""==t&&$.each(a.smallPackageList,function(e,r){return Cart.isNotNull(a.errorDesc)?(t=a.productName+r.errorDesc,!1):void 0}),!1):void("XNPACKAGE"==a.packageType&&$.each(a.xnPackageList,function(e,a){return r.indexOf(","+a.orderItemId+",")>=0&&Cart.isNotNull(a.errorDesc)?(t=a.productName+a.errorDesc,!1):void 0}))}),""==t&&$.each(e.cShopExceptionList,function(e,a){return $.each(a.itemList,function(e,a){return r.indexOf(","+a.orderItemId+",")>=0&&Cart.isNotNull(a.errorDesc)?(t=a.productName+a.errorDesc,!1):void("XNPACKAGE"==a.packageType&&$.each(a.xnPackageList,function(e,a){return r.indexOf(","+a.orderItemId+",")>=0&&Cart.isNotNull(a.errorDesc)?(t=a.productName+a.errorDesc,!1):void 0}))}),Cart.isNotNull(t)?!1:void 0}),t},refreshErrorDesc:function(e,t){$.each(e,function(e,t){$("#error_message_"+t.orderItemId).html(t.errorDesc),"XNPACKAGE"==t.packageType&&$.each(t.xnPackageList,function(e,t){$("#error_message_"+t.orderItemId).html(t.errorDesc)})}),$.each(t,function(e,t){$.each(t.itemList,function(e,t){$("#error_message_cshop_"+t.orderItemId).html(t.errorDesc),"XNPACKAGE"==t.packageType&&$.each(t.xnPackageList,function(e,t){$("#error_message_cshop_"+t.orderItemId).html(t.errorDesc)})})})},predo:function(callFun){probeAuthStatus(function(){eval(callFun)},function(){var e=Cart.useMethod.isHasChecked("#hwgList"),t=Cart.useMethod.isHasChecked("#cartList");if(e&&t)Cart.useMethod.alertMini("【海外购商品】和【非海外购商品】不可一起结算，请分开进行结算");else if(e){var r=SN.CART+"/cart/cart1.html?settlementFlag=1";window.location.href=SN.PASSPORT+"/login?service="+SN.AQ+"?targetUrl="+encodeURIComponent(r)+"&terminalFlag=0&loginTheme=wap_new"}else t&&Cart.linkUrl.goLogon()})}},Cart.updateService={updateServerItem:function(e,t,r,a,i,o,n){var s;if(""==e)s=o;else if(Array.isArray(e)){var c={},l=[];$.each(e,function(e,t){c={itemId:t+"",productId:"",quantity:"",special:"",flag:"",deleteFlag:r+""},l[e]=c}),s={items:l}}else s={items:[{itemId:e+"",productId:"",quantity:t+"",special:"",flag:""!=i&&void 0!=i&&"undefined"!=i?i+"":"",deleteFlag:r+""}]};var d={storeId:"10052",curCityId:$.cookie("cityId")||"9173",updateInfo:JSON.stringify(s),supportPackage:"1",supportAccePack:"0",channel:"5",mpsChannel:"5",updateNum:updateFlag,updateWAPCartCookie:1,supportXN:1};$.ajax({type:"get",url:SN.CART1_QUERY_URL,data:d,dataType:"jsonp",jsonp:"callback",beforeSend:function(){$("#loading").show()},success:function(e){if(updateUidArr.push(1),updateFlag="0",!isDelAllFlag&&"isAll"!=n&&(updateUidArr=[1,1]),""!=e.missItemId&&"1"!=a)isDelAllFlag?Cart.useMethod.delAlertMessage(updateUidArr,0):(Cart.useMethod.alertMini("啊哦~操作失败了"),setTimeout(function(){Cart.useMethod.refreshCurPage()},2e3));else if(!parseInt($("#cartEdit").attr("rel"))||Cart.isNotNull(a)||Cart.isNotNull(r)){if($("#cartList").html(""),allItemChecked=!0,canCheckAllItem=!1,checkedItem="",Cart.queryData.initialSNCartList(e),Cart.queryData.initialCCartList(e.cShopList),$.cookie("checkedItems",","+checkedItem,{path:"/",domain:SN.IDS_COOKIE_DOMAIN,expires:10}),Cart.settlement.refreshErrorDesc(e.itemList,e.cShopList),userPayAllPrice=e.userPayAllPrice,totalDiscount=e.totalDiscount,"1"==r&&"1"!=a)if(isDelAllFlag)Cart.useMethod.delAlertMessage(updateUidArr,1);else var t=setTimeout(function(){Cart.useMethod.alertMini("删除成功"),clearTimeout(t)},500)}else isUpdateQty=!0,Cart.settlement.refreshErrorDesc(e.itemList,e.cShopList)},complete:function(){updateFlag="0",isUpdateQty?$("#loading").hide():Cart.useMethod.isEmptyCart(updateUidArr)?Cart.useMethod.showEmptyCart():($(".cart-list-opra").addClass("no-effect"),Cart.useMethod.ajaxFixedBox(updateUidArr))
},error:function(){updateUidArr.push(0),Cart.useMethod.ajaxUpdateFail(updateUidArr)}})},refreshDynamicPart:function(){var e={storeId:"10052",isMerge:"0",supportCShop:"1",supportPackage:"1",supportAccePack:"0",supportCShopCheck:"1",channel:"5",mpsChannel:"5",updateNum:updateFlag,updateWAPCartCookie:1,supportXN:1};$.ajax({type:"get",url:SN.CART1_QUERY_URL,dataType:"jsonp",data:e,jsonp:"callback",beforeSend:function(){$("#loading").show()},success:function(e){parseInt($("#cartEdit").attr("rel"))?(isUpdateQty=!0,Cart.settlement.refreshErrorDesc(e.itemList,e.cShopList)):($("#cartList").html(""),allItemChecked=!0,canCheckAllItem=!1,checkedItem="",Cart.queryData.initialSNCartList(e),Cart.queryData.initialCCartList(e.cShopList),$.cookie("checkedItems",","+checkedItem,{path:"/",domain:SN.IDS_COOKIE_DOMAIN,expires:10}),Cart.settlement.refreshErrorDesc(e.itemList,e.cShopList),userPayAllPrice=e.userPayAllPrice||0,totalDiscount=e.totalDiscount||0,Cart.useMethod.initFixedBox())},complete:function(){$("#loading").hide(),Cart.useMethod.initialCheckedAll()},error:function(){$("#loading").hide(),Cart.useMethod.alertMini("网络连接失败，请检测您的网络环境稍后重试")}})}},Cart.updateCookie={initialEmptyQty:function(){var e=new Date;e.setTime(e.getTime()+2592e6),$.cookie("totalProdQtyv3",0,{path:"/",domain:SN.IDS_COOKIE_DOMAIN,expires:e}),$.cookie("totalCheckedQty",0,{path:"/",domain:SN.IDS_COOKIE_DOMAIN,expires:e})},updateCookieQty:function(e,t){var r={quantity:t,itemId:e};$.ajax({type:"get",url:SN.APP+"/cart1/updateCookieQty.do",dataType:"jsonp",jsonp:"callback",data:r,cache:!1,async:!0,success:function(){},complete:function(){probeAuthStatus(function(){Cart.updateService.updateServerItem(e+"",t,"")},function(){Cart.updateService.refreshDynamicPart()})}})},updateCookieCheck:function(e,t,r,a,i,o,n){var s={itemId:e,supplierCode:t,shopType:r,isSelected:a};$.ajax({url:SN.APP+"/cart1/updateCookieCheck.do",type:"get",dataType:"jsonp",jsonp:"callback",data:s,cache:!1,async:!0,success:function(){},complete:function(){probeAuthStatus(function(){""==i?Cart.updateService.updateServerItem("","","","","",o,n):Cart.updateService.updateServerItem(e+"","","","",a)},function(){Cart.updateService.refreshDynamicPart()})}})}}}(),function(){var e=function(){function e(e,c){var l,d;if(r(),e.src){e.src=e.src.constructor===Array?e.src:[e.src];for(var u=0;u<e.src.length;u++)e.src[u].constructor!==Array&&(e.src[u]=[e.src[u]]),s.push(e.src[u])}n=s.shift(),a=a||o.getElementsByTagName("head")[0],e.src=n;for(var u=0;u<e.src.length;u++)d=e.src[u],l=o.createElement("script"),l.src=d,l.type="text/javascript",i.ie?l.onreadystatechange=function(){var r=this.readyState;("loaded"===r||"complete"===r)&&(this.onreadystatechange=null,t(e,c))}:l.onload=l.onerror=function(){t(e,c)},a.appendChild(l)}function t(t,r){var a=n;if(a&&(a.shift(),!a.length)){if(!s.length)return void("function"==typeof r&&r());e(t,r)}}function r(){if(!i){var e=/msie/i.test(navigator.userAgent.toLowerCase());i={ie:e}}}var a,i,o=document,n=[],s=[];return{init:function(t,r){e(t,r)}}}();navigator.userAgent.match(/SNEBUY-APP/i)?document.body.insertAdjacentHTML("beforeend",'<input type="hidden" id="resourceType" value="inapp">'):document.body.insertAdjacentHTML("beforeend",'<input type="hidden" id="resourceType" value="wap">'),window.addEventListener("load",function(){e.init({src:["http://prescript.suning.cn/javascript/sn_da/da_opt.js"]})})}();